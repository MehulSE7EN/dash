<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Physics Protocol: WAR MODE</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Orbitron:wght@700;900&display=swap" rel="stylesheet">
    <style>
        @keyframes pulse-red {
            0%, 100% { box-shadow: 0 0 15px rgba(239, 68, 68, 0.4); }
            50% { box-shadow: 0 0 25px rgba(239, 68, 68, 0.7); }
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: #000000;
            background-image: radial-gradient(circle at top right, rgba(239, 68, 68, 0.1), transparent 50%),
                              radial-gradient(circle at bottom left, rgba(249, 115, 22, 0.1), transparent 50%);
            color: #9ca3af;
        }
        .font-orbitron {
            font-family: 'Orbitron', sans-serif;
        }
        .hud-pane {
            background: rgba(10, 5, 5, 0.5);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(239, 68, 68, 0.2);
            box-shadow: inset 0 0 15px rgba(239, 68, 68, 0.1);
        }
        details > summary { list-style: none; cursor: pointer; }
        details > summary::-webkit-details-marker { display: none; }
        details[open] .arrow { transform: rotate(90deg); }
        .arrow { transition: transform 0.2s ease-in-out; }
        .task-card {
            transition: all 0.2s ease-in-out;
            border-left: 4px solid #4b5569;
            background: rgba(17, 24, 39, 0.3);
        }
        .task-card:hover {
            background-color: rgba(239, 68, 68, 0.1);
            border-left-color: #ef4444;
        }
        .task-card.completed {
            opacity: 0.4;
            border-left-color: #22c55e;
            background: transparent;
        }
        .task-card.completed .task-title {
            text-decoration: line-through;
            text-decoration-color: #6b7280;
        }
        .current-day-active {
            border: 1px solid rgba(249, 115, 22, 0.5);
            animation: pulse-red 2s infinite;
        }
        
        /* Custom Checkbox */
        .custom-checkbox input { display: none; }
        .custom-checkbox .checkmark {
            height: 20px; width: 20px; background-color: transparent;
            border: 2px solid #6b7280; border-radius: 4px; display: inline-block; 
            position: relative; cursor: pointer; transition: all 0.2s;
        }
        .custom-checkbox:hover .checkmark { border-color: #ef4444; }
        .custom-checkbox input:checked + .checkmark { background-color: #ef4444; border-color: #ef4444; }
        .custom-checkbox .checkmark:after {
            content: ""; position: absolute; display: none; left: 6px; top: 2px;
            width: 5px; height: 10px; border: solid white; border-width: 0 3px 3px 0;
            transform: rotate(45deg);
        }
        .custom-checkbox input:checked + .checkmark:after { display: block; }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="max-w-4xl mx-auto">
        <header class="text-center mb-6">
            <h1 class="text-3xl md:text-4xl font-orbitron text-red-500 tracking-wider uppercase">War Protocol Engaged</h1>
            <p class="text-orange-400 mt-2">Mission: Physics Syllabus Annihilation</p>
        </header>

        <div class="hud-pane rounded-xl p-4 md:p-6 mb-8 text-center">
            <h2 class="font-orbitron text-lg text-gray-400 uppercase tracking-widest">Time Remaining</h2>
            <div id="countdown-timer" class="text-3xl md:text-5xl font-orbitron text-white my-2">
                <span>00d</span> : <span>00h</span> : <span>00m</span> : <span>00s</span>
            </div>
        </div>

        <div class="hud-pane rounded-xl p-6 mb-8">
            <div class="flex justify-between items-center mb-2">
                <span class="text-sm font-orbitron text-gray-300">PROTOCOL STATUS</span>
                <span id="progress-text" class="text-sm font-bold text-orange-400">0%</span>
            </div>
            <div class="w-full bg-black/50 rounded-full h-2.5 border border-gray-700">
                <div id="progress-bar" class="bg-gradient-to-r from-orange-500 to-red-600 h-full rounded-full transition-all duration-500" style="width: 0%"></div>
            </div>
        </div>

        <div id="plan-container" class="space-y-6">
            <!-- Plan will be generated by JS -->
        </div>
        
        <div class="text-center mt-8">
             <button id="reset-button" class="text-xs text-gray-600 hover:text-red-500 transition-colors uppercase">Reset Protocol</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const planContainer = document.getElementById('plan-container');
            const progressBar = document.getElementById('progress-bar');
            const progressText = document.getElementById('progress-text');
            const resetButton = document.getElementById('reset-button');
            const countdownTimer = document.getElementById('countdown-timer');

            const storageKey = 'physicsProtocolProgress_war_v1';
            const startDateKey = 'physicsProtocolStartDate_war_v1';

            const planData = [
                // Data is the same as previous version
                { week: 1, day: 1, title: "Finish Motion in a Straight Line", practice: "Solve 30-40 questions from the chapter." }, { week: 1, day: 2, title: "Revise & Buffer Day", practice: "Revise all formulas and attempt a chapter-wise test." }, { week: 1, day: 3, title: "Motion in a Plane - Lec 1 (Vectors 1)", practice: "N/A" }, { week: 1, day: 4, title: "Motion in a Plane - Lec 2 (Vectors 2)", practice: "Practice questions from Lec 1." }, { week: 1, day: 5, title: "Motion in a Plane - Lec 3", practice: "Practice questions from Lec 2." }, { week: 1, day: 6, title: "Motion in a Plane - Lec 4", practice: "Practice questions from Lec 3." }, { week: 1, day: 7, title: "Motion in a Plane - Lec 5", practice: "Practice questions from Lec 4." }, { week: 2, day: 8, title: "Motion in a Plane - Lec 6", practice: "Practice questions from Lec 5." }, { week: 2, day: 9, title: "Revision & Buffer Day", practice: "Revise Vectors & Motion in a Plane concepts." }, { week: 2, day: 10, title: "Motion in a Plane - Lec 7", practice: "Practice questions from Lec 6." }, { week: 2, day: 11, title: "Motion in a Plane - Lec 8", practice: "Practice questions from Lec 7." }, { week: 2, day: 12, title: "Motion in a Plane - Lec 9", practice: "Practice questions from Lec 8." }, { week: 2, day: 13, title: "Motion in a Plane - Lec 10 (Final)", practice: "Practice questions from Lec 9." }, { week: 2, day: 14, title: "NLM - Lec 1", practice: "Final practice from Motion in a Plane." }, { week: 3, day: 15, title: "NLM - Lec 2", practice: "Practice questions from NLM Lec 1." }, { week: 3, day: 16, title: "Revision & Buffer Day", practice: "Revise Motion in a Plane fully. Create formula sheet." }, { week: 3, day: 17, title: "NLM - Lec 3", practice: "Practice questions from NLM Lec 2." }, { week: 3, day: 18, title: "NLM - Lec 4", practice: "Practice questions from NLM Lec 3." }, { week: 3, day: 19, title: "NLM - Lec 5", practice: "Practice questions from NLM Lec 4." }, { week: 3, day: 20, title: "NLM - Lec 6", practice: "Practice questions from NLM Lec 5." }, { week: 3, day: 21, title: "NLM - Lec 7", practice: "Practice questions from NLM Lec 6." }, { week: 4, day: 22, title: "NLM - Lec 8", practice: "Practice questions from NLM Lec 7." }, { week: 4, day: 23, title: "Revision & Buffer Day", practice: "Revise NLM concepts (FBD, Friction)." }, { week: 4, day: 24, title: "NLM - Lec 9", practice: "Practice questions from NLM Lec 8." }, { week: 4, day: 25, title: "NLM - Lec 10", practice: "Practice questions from NLM Lec 9." }, { week: 4, day: 26, title: "NLM - Lec 11 (Final)", practice: "Practice questions from NLM Lec 10." }, { week: 4, day: 27, title: "WEP - Lec 1", practice: "Final practice from NLM." }, { week: 4, day: 28, title: "WEP - Lec 2", practice: "Practice questions from WEP Lec 1." }, { week: 5, day: 29, title: "WEP - Lec 3", practice: "Practice questions from WEP Lec 2." }, { week: 5, day: 30, title: "Revision & Buffer Day", practice: "Revise NLM fully. Attempt chapter test." }, { week: 5, day: 31, title: "WEP - Lec 4", practice: "Practice questions from WEP Lec 3." }, { week: 5, day: 32, title: "WEP - Lec 5", practice: "Practice questions from WEP Lec 4." }, { week: 5, day: 33, title: "WEP - Lec 6", practice: "Practice questions from WEP Lec 5." }, { week: 5, day: 34, title: "WEP - Lec 7", practice: "Practice questions from WEP Lec 6." }, { week: 5, day: 35, title: "WEP - Lec 8 (Final)", practice: "Practice questions from WEP Lec 7." }, { week: 5, day: 36, title: "Final Practice", practice: "Practice WEP questions and create full syllabus formula sheet." }
            ];

            function getStartDate() {
                let storedDate = localStorage.getItem(startDateKey);
                if (!storedDate) {
                    storedDate = new Date().toISOString();
                    localStorage.setItem(startDateKey, storedDate);
                }
                return new Date(storedDate);
            }
            
            const startDate = getStartDate();

            function startCountdown() {
                const missionDurationDays = 36;
                const endDate = new Date(startDate);
                endDate.setDate(startDate.getDate() + missionDurationDays);

                setInterval(() => {
                    const now = new Date();
                    const timeLeft = endDate - now;

                    if (timeLeft < 0) {
                        countdownTimer.innerHTML = "MISSION COMPLETE";
                        return;
                    }

                    const d = Math.floor(timeLeft / (1000 * 60 * 60 * 24));
                    const h = Math.floor((timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                    const m = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
                    const s = Math.floor((timeLeft % (1000 * 60)) / 1000);

                    countdownTimer.innerHTML = `
                        <span>${String(d).padStart(2, '0')}d</span> : 
                        <span>${String(h).padStart(2, '0')}h</span> : 
                        <span>${String(m).padStart(2, '0')}m</span> : 
                        <span>${String(s).padStart(2, '0')}s</span>`;
                }, 1000);
            }

            function generatePlanHTML() {
                const today = new Date();
                today.setHours(0, 0, 0, 0); // Normalize today's date
                let currentWeek = 0;
                let weekHTML = '';

                planData.forEach((task, index) => {
                    if (task.week !== currentWeek) {
                        if (currentWeek !== 0) { weekHTML += `</div></details>`; }
                        currentWeek = task.week;
                        weekHTML += `<details class="hud-pane rounded-xl" ${currentWeek === 1 ? 'open' : ''}>
                            <summary class="p-4 flex justify-between items-center">
                                <h2 class="text-xl font-orbitron text-white uppercase">Week ${currentWeek}</h2>
                                <svg class="arrow w-6 h-6 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
                            </summary>
                            <div class="p-4 border-t border-red-900/50 space-y-3">`;
                    }

                    const taskDate = new Date(startDate);
                    taskDate.setDate(startDate.getDate() + index);
                    const dateString = taskDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
                    taskDate.setHours(0,0,0,0);
                    
                    const isToday = today.getTime() === taskDate.getTime();
                    const dayClass = isToday ? 'current-day-active' : '';

                    const taskId1 = `task-${task.day}-1`;
                    const taskId2 = `task-${task.day}-2`;

                    weekHTML += `<div class="task-card p-4 rounded-lg flex items-start space-x-4 ${dayClass}">
                        <div class="w-20 text-sm font-semibold text-gray-400 text-center">
                            <p>DAY ${task.day}</p>
                            <p class="text-xs">${dateString}</p>
                        </div>
                        <div class="flex-grow space-y-2">
                            <div class="flex items-center"><label class="custom-checkbox mr-3"><input type="checkbox" id="${taskId1}"><span class="checkmark"></span></label><label for="${taskId1}" class="task-title flex-grow font-semibold text-slate-200 cursor-pointer">${task.title}</label></div>
                            <div class="flex items-center pl-8"><label class="custom-checkbox mr-3"><input type="checkbox" id="${taskId2}"><span class="checkmark"></span></label><label for="${taskId2}" class="task-title flex-grow text-sm text-slate-400 cursor-pointer">${task.practice}</label></div>
                        </div>
                    </div>`;
                });

                weekHTML += `</div></details>`;
                planContainer.innerHTML = weekHTML;
            }

            function updateProgress() {
                const checkboxes = document.querySelectorAll('.custom-checkbox input');
                const totalTasks = checkboxes.length;
                if (totalTasks === 0) return;
                const completedTasks = document.querySelectorAll('.custom-checkbox input:checked').length;
                const percentage = Math.round((completedTasks / totalTasks) * 100);
                progressBar.style.width = `${percentage}%`;
                progressText.textContent = `${percentage}% ELIMINATED`;
                saveProgress();
            }

            function saveProgress() {
                const progress = {};
                document.querySelectorAll('.custom-checkbox input').forEach(checkbox => {
                    progress[checkbox.id] = checkbox.checked;
                });
                localStorage.setItem(storageKey, JSON.stringify(progress));
            }

            function loadProgress() {
                const savedProgress = JSON.parse(localStorage.getItem(storageKey));
                if (savedProgress) {
                    document.querySelectorAll('.custom-checkbox input').forEach(checkbox => {
                        if (savedProgress[checkbox.id]) { checkbox.checked = true; }
                    });
                }
            }
            
            function applyCompletedStyles() {
                 document.querySelectorAll('.custom-checkbox input').forEach(checkbox => {
                    const card = checkbox.closest('.task-card');
                    const allCheckboxesInCard = card.querySelectorAll('input[type="checkbox"]');
                    const allChecked = Array.from(allCheckboxesInCard).every(cb => cb.checked);
                    card.classList.toggle('completed', allChecked);
                 });
            }

            function addEventListeners() {
                document.querySelectorAll('.custom-checkbox input').forEach(checkbox => {
                    checkbox.addEventListener('change', () => {
                        applyCompletedStyles();
                        updateProgress();
                    });
                });
                resetButton.addEventListener('click', () => {
                    if (window.confirm('WARNING: This will reset all mission progress. Are you sure?')) {
                        localStorage.removeItem(storageKey);
                        localStorage.removeItem(startDateKey);
                        window.location.reload();
                    }
                });
            }

            // Initial setup
            generatePlanHTML();
            loadProgress();
            applyCompletedStyles();
            updateProgress();
            addEventListeners();
            startCountdown();
        });
    </script>
</body>
</html>
